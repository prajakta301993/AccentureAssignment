package com.accenture.AccentureAssignment.serviceTest;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertTrue;

import java.util.HashMap;
import java.util.Map;

import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.junit.jupiter.MockitoExtension;

import com.accenture.AccentureAssignment.service.AccentureService;
import com.google.gson.Gson;


@ExtendWith(MockitoExtension.class)
public class AccentureServiceTest {
	
	@InjectMocks
	private AccentureService serviceAssignment;
	
	
	@SuppressWarnings({ "rawtypes", "unchecked" })
	@Test
	public void calCorrelationCoefficent() {
		
		String casesResponse="{\"Australia\": {\"All\": {\"confirmed\": 4848211, \"recovered\": 0, \"deaths\": 6462, \"country\": \"Australia\", \"population\": 24450561, \"sq_km_area\": 7741220, \"life_expectancy\": \"79.8\", \"elevation_in_meters\": 330, \"continent\": \"Oceania\", \"abbreviation\": \"AU\", \"location\": \"Australia and New Zealand\", \"iso\": 36, \"capital_city\": \"Canberra\"}, \"Australian Capital Territory\": {\"lat\": \"-35.4735\", \"long\": \"149.0124\", \"confirmed\": 81821, \"recovered\": 0, \"deaths\": 43, \"updated\": \"2022-04-06 04:20:49\"}, \"New South Wales\": {\"lat\": \"-33.8688\", \"long\": \"151.2093\", \"confirmed\": 1938880, \"recovered\": 0, \"deaths\": 2487, \"updated\": \"2022-04-06 04:20:49\"}, \"Northern Territory\": {\"lat\": \"-12.4634\", \"long\": \"130.8456\", \"confirmed\": 52334, \"recovered\": 0, \"deaths\": 36, \"updated\": \"2022-04-06 04:20:49\"}, \"Queensland\": {\"lat\": \"-27.4698\", \"long\": \"153.0251\", \"confirmed\": 820041, \"recovered\": 0, \"deaths\": 756, \"updated\": \"2022-04-06 04:20:49\"}, \"South Australia\": {\"lat\": \"-34.9285\", \"long\": \"138.6007\", \"confirmed\": 290824, \"recovered\": 0, \"deaths\": 270, \"updated\": \"2022-04-06 04:20:49\"}, \"Tasmania\": {\"lat\": \"-42.8821\", \"long\": \"147.3272\", \"confirmed\": 101435, \"recovered\": 0, \"deaths\": 32, \"updated\": \"2022-04-06 04:20:49\"}, \"Victoria\": {\"lat\": \"-37.8136\", \"long\": \"144.9631\", \"confirmed\": 1343648, \"recovered\": 0, \"deaths\": 2766, \"updated\": \"2022-04-06 04:20:49\"}, \"Western Australia\": {\"lat\": \"-31.9505\", \"long\": \"115.8605\", \"confirmed\": 219228, \"recovered\": 0, \"deaths\": 72, \"updated\": \"2022-04-06 04:20:49\"}}, \"Fiji\": {\"All\": {\"confirmed\": 64425, \"recovered\": 0, \"deaths\": 834, \"country\": \"Fiji\", \"population\": 905502, \"sq_km_area\": 18274, \"life_expectancy\": \"67.9\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"FJ\", \"location\": \"Melanesia\", \"iso\": null, \"capital_city\": \"Suva\", \"lat\": \"-17.7134\", \"long\": \"178.065\", \"updated\": \"2022-04-06 04:20:49\"}}, \"Kiribati\": {\"All\": {\"confirmed\": 3067, \"recovered\": 0, \"deaths\": 13, \"country\": \"Kiribati\", \"population\": 116398, \"sq_km_area\": 726, \"life_expectancy\": \"59.8\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"KI\", \"location\": \"Micronesia\", \"iso\": 296, \"capital_city\": \"Bairiki\", \"lat\": \"-3.3704\", \"long\": \"-168.734\", \"updated\": \"2022-04-06 04:20:49\"}}, \"Marshall Islands\": {\"All\": {\"confirmed\": 7, \"recovered\": 0, \"deaths\": 0, \"country\": \"Marshall Islands\", \"population\": 53127, \"sq_km_area\": 181, \"life_expectancy\": \"65.5\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"MH\", \"location\": \"Micronesia\", \"iso\": 584, \"capital_city\": \"Dalap-Uliga-Darrit\", \"lat\": \"7.1315\", \"long\": \"171.1845\", \"updated\": \"2022-04-06 04:20:49\"}}, \"New Zealand\": {\"All\": {\"confirmed\": 730285, \"recovered\": 0, \"deaths\": 404, \"country\": \"New Zealand\", \"population\": 4705818, \"sq_km_area\": 270534, \"life_expectancy\": \"77.8\", \"elevation_in_meters\": 388, \"continent\": \"Oceania\", \"abbreviation\": \"NZ\", \"location\": \"Australia and New Zealand\", \"iso\": 554, \"capital_city\": \"Wellington\", \"lat\": \"-40.9006\", \"long\": \"174.886\", \"updated\": \"2022-04-06 04:20:49\"}, \"Cook Islands\": {\"lat\": \"-21.2367\", \"long\": \"-159.7777\", \"confirmed\": 2715, \"recovered\": 0, \"deaths\": 0, \"updated\": \"2022-04-06 04:20:49\"}}, \"Palau\": {\"All\": {\"confirmed\": 4070, \"recovered\": 0, \"deaths\": 6, \"country\": \"Palau\", \"population\": 21729, \"sq_km_area\": 459, \"life_expectancy\": \"68.6\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"PW\", \"location\": \"Micronesia\", \"iso\": 585, \"capital_city\": \"Koror\", \"lat\": \"7.515\", \"long\": \"134.5825\", \"updated\": \"2022-04-06 04:20:49\"}}, \"Papua New Guinea\": {\"All\": {\"confirmed\": 43374, \"recovered\": 0, \"deaths\": 643, \"country\": \"Papua New Guinea\", \"population\": 8251162, \"sq_km_area\": 462840, \"life_expectancy\": \"63.1\", \"elevation_in_meters\": 667, \"continent\": \"Oceania\", \"abbreviation\": \"PG\", \"location\": \"Melanesia\", \"iso\": 598, \"capital_city\": \"Port Moresby\", \"lat\": \"-6.314993\", \"long\": \"143.95555\", \"updated\": \"2022-04-06 04:20:49\"}}, \"Samoa\": {\"All\": {\"confirmed\": 2622, \"recovered\": 0, \"deaths\": 2, \"country\": \"Samoa\", \"population\": 196440, \"sq_km_area\": 2831, \"life_expectancy\": \"69.2\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"WS\", \"location\": \"Polynesia\", \"iso\": 882, \"capital_city\": \"Apia\", \"lat\": \"-13.759\", \"long\": \"-172.1046\", \"updated\": \"2022-04-06 04:20:49\"}}, \"Solomon Islands\": {\"All\": {\"confirmed\": 11856, \"recovered\": 0, \"deaths\": 136, \"country\": \"Solomon Islands\", \"population\": 611343, \"sq_km_area\": 28896, \"life_expectancy\": \"71.3\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"SB\", \"location\": \"Melanesia\", \"iso\": 90, \"capital_city\": \"Honiara\", \"lat\": \"-9.6457\", \"long\": \"160.1562\", \"updated\": \"2022-04-06 04:20:49\"}}, \"Tonga\": {\"All\": {\"confirmed\": 7385, \"recovered\": 0, \"deaths\": 9, \"country\": \"Tonga\", \"population\": 108020, \"sq_km_area\": 650, \"life_expectancy\": \"67.9\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"TO\", \"location\": \"Polynesia\", \"iso\": 776, \"capital_city\": \"Nuku'alofa\", \"lat\": \"-21.179000000000002\", \"long\": \"-175.1982\", \"updated\": \"2022-04-06 04:20:49\"}}, \"Vanuatu\": {\"All\": {\"confirmed\": 4438, \"recovered\": 0, \"deaths\": 2, \"country\": \"Vanuatu\", \"population\": 276244, \"sq_km_area\": 12189, \"life_expectancy\": \"60.6\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"VU\", \"location\": \"Melanesia\", \"iso\": 548, \"capital_city\": \"Port-Vila\", \"lat\": \"-15.3767\", \"long\": \"166.9592\", \"updated\": \"2022-04-06 04:20:49\"}}}";
		String vaccineResponse = "{\"Australia\": {\"All\": {\"administered\": 56719978, \"people_vaccinated\": 21307694, \"people_partially_vaccinated\": 22222194, \"country\": \"Australia\", \"population\": 24450561, \"sq_km_area\": 7741220, \"life_expectancy\": \"79.8\", \"elevation_in_meters\": 330, \"continent\": \"Oceania\", \"abbreviation\": \"AU\", \"location\": \"Australia and New Zealand\", \"iso\": 36, \"capital_city\": \"Canberra\", \"updated\": \"2022/04/06 00:00:00+00\"}, \"Australian Capital Territory\": {\"administered\": 1469708, \"people_vaccinated\": 0, \"people_partially_vaccinated\": 0, \"updated\": \"2022/04/06 00:00:00+00\"}, \"New South Wales\": {\"administered\": 17609625, \"people_vaccinated\": 0, \"people_partially_vaccinated\": 0, \"updated\": \"2022/04/06 00:00:00+00\"}, \"Northern Territory\": {\"administered\": 556247, \"people_vaccinated\": 0, \"people_partially_vaccinated\": 0, \"updated\": \"2022/04/06 00:00:00+00\"}, \"Queensland\": {\"administered\": 10744969, \"people_vaccinated\": 0, \"people_partially_vaccinated\": 0, \"updated\": \"2022/04/06 00:00:00+00\"}, \"South Australia\": {\"administered\": 3907371, \"people_vaccinated\": 0, \"people_partially_vaccinated\": 0, \"updated\": \"2022/04/06 00:00:00+00\"}, \"Tasmania\": {\"administered\": 1275611, \"people_vaccinated\": 0, \"people_partially_vaccinated\": 0, \"updated\": \"2022/04/06 00:00:00+00\"}, \"Unknown\": {\"administered\": 0, \"people_vaccinated\": 0, \"people_partially_vaccinated\": 0, \"updated\": \"2022/04/06 00:00:00+00\"}, \"Victoria\": {\"administered\": 14947931, \"people_vaccinated\": 0, \"people_partially_vaccinated\": 0, \"updated\": \"2022/04/06 00:00:00+00\"}, \"Western Australia\": {\"administered\": 6208516, \"people_vaccinated\": 0, \"people_partially_vaccinated\": 0, \"updated\": \"2022/04/06 00:00:00+00\"}}, \"Fiji\": {\"All\": {\"administered\": 1428275, \"people_vaccinated\": 628308, \"people_partially_vaccinated\": 682439, \"country\": \"Fiji\", \"population\": 905502, \"sq_km_area\": 18274, \"life_expectancy\": \"67.9\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"FJ\", \"location\": \"Melanesia\", \"iso\": null, \"capital_city\": \"Suva\", \"updated\": \"2022/04/06 00:00:00+00\"}}, \"Kiribati\": {\"All\": {\"administered\": 136758, \"people_vaccinated\": 55333, \"people_partially_vaccinated\": 78620, \"country\": \"Kiribati\", \"population\": 116398, \"sq_km_area\": 726, \"life_expectancy\": \"59.8\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"KI\", \"location\": \"Micronesia\", \"iso\": 296, \"capital_city\": \"Bairiki\", \"updated\": \"2022/04/06 00:00:00+00\"}}, \"Marshall Islands\": {\"All\": {\"administered\": 60962, \"people_vaccinated\": 0, \"people_partially_vaccinated\": 0, \"country\": \"Marshall Islands\", \"population\": 53127, \"sq_km_area\": 181, \"life_expectancy\": \"65.5\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"MH\", \"location\": \"Micronesia\", \"iso\": 584, \"capital_city\": \"Dalap-Uliga-Darrit\", \"updated\": \"2022/04/06 00:00:00+00\"}}, \"New Zealand\": {\"All\": {\"administered\": 10977818, \"people_vaccinated\": 4068608, \"people_partially_vaccinated\": 4285332, \"country\": \"New Zealand\", \"population\": 4705818, \"sq_km_area\": 270534, \"life_expectancy\": \"77.8\", \"elevation_in_meters\": 388, \"continent\": \"Oceania\", \"abbreviation\": \"NZ\", \"location\": \"Australia and New Zealand\", \"iso\": 554, \"capital_city\": \"Wellington\", \"updated\": \"2022/04/06 00:00:00+00\"}, \"Cook Islands\": {\"administered\": 39468, \"people_vaccinated\": 0, \"people_partially_vaccinated\": 0, \"updated\": \"2022/04/06 00:00:00+00\"}}, \"Palau\": {\"All\": {\"administered\": 44526, \"people_vaccinated\": 0, \"people_partially_vaccinated\": 0, \"country\": \"Palau\", \"population\": 21729, \"sq_km_area\": 459, \"life_expectancy\": \"68.6\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"PW\", \"location\": \"Micronesia\", \"iso\": 585, \"capital_city\": \"Koror\", \"updated\": \"2022/04/06 00:00:00+00\"}}, \"Papua New Guinea\": {\"All\": {\"administered\": 574716, \"people_vaccinated\": 257566, \"people_partially_vaccinated\": 317150, \"country\": \"Papua New Guinea\", \"population\": 8251162, \"sq_km_area\": 462840, \"life_expectancy\": \"63.1\", \"elevation_in_meters\": 667, \"continent\": \"Oceania\", \"abbreviation\": \"PG\", \"location\": \"Melanesia\", \"iso\": 598, \"capital_city\": \"Port Moresby\", \"updated\": \"2022/04/06 00:00:00+00\"}}, \"Samoa\": {\"All\": {\"administered\": 339214, \"people_vaccinated\": 132018, \"people_partially_vaccinated\": 184033, \"country\": \"Samoa\", \"population\": 196440, \"sq_km_area\": 2831, \"life_expectancy\": \"69.2\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"WS\", \"location\": \"Polynesia\", \"iso\": 882, \"capital_city\": \"Apia\", \"updated\": \"2022/04/06 00:00:00+00\"}}, \"Solomon Islands\": {\"All\": {\"administered\": 369713, \"people_vaccinated\": 122405, \"people_partially_vaccinated\": 235668, \"country\": \"Solomon Islands\", \"population\": 611343, \"sq_km_area\": 28896, \"life_expectancy\": \"71.3\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"SB\", \"location\": \"Melanesia\", \"iso\": 90, \"capital_city\": \"Honiara\", \"updated\": \"2022/04/06 00:00:00+00\"}}, \"Vanuatu\": {\"All\": {\"administered\": 199810, \"people_vaccinated\": 85180, \"people_partially_vaccinated\": 114284, \"country\": \"Vanuatu\", \"population\": 276244, \"sq_km_area\": 12189, \"life_expectancy\": \"60.6\", \"elevation_in_meters\": null, \"continent\": \"Oceania\", \"abbreviation\": \"VU\", \"location\": \"Melanesia\", \"iso\": 548, \"capital_city\": \"Port-Vila\", \"updated\": \"2022/04/06 00:00:00+00\"}}}";
		
		HashMap<String, Map> casesJson = new Gson().fromJson(casesResponse, HashMap.class);
		HashMap<String, Map> vaccineJson = new Gson().fromJson(vaccineResponse, HashMap.class);
		assertEquals(0.27549365162849426, (float)( serviceAssignment.calCorrelationCoefficent(casesJson, vaccineJson)));
		assertTrue(casesJson.containsKey("Australia"));
		assertTrue(casesJson.get("Australia").containsKey("All"));
		assertTrue(vaccineJson.containsKey("Australia"));
		assertTrue(vaccineJson.get("Australia").containsKey("All"));
		
		
	}
	
	@Test
	public void isValidContinent() {
		
		String continent = "Africa";
		//When parameter is not passed
		String nullContinent = null;
		String wrongContinent = "Australia";
		
		assertEquals(true, serviceAssignment.isValidContinent(continent));
		assertEquals(true, serviceAssignment.isValidContinent(nullContinent));
		assertEquals(false, serviceAssignment.isValidContinent(wrongContinent));
		
	}

}
